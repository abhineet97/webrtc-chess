<!DOCTYPE html><title>WebRTC Chess</title><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><style>.chessboard{position:relative;margin-left:auto;margin-right:auto;border:2px solid #444}.chessboard.flipped,.chessboard.flipped .black.square,.chessboard.flipped .promotion-wrapper,.chessboard.flipped .white.square{transform:rotate(180deg);-webkit-transform:rotate(180deg)}.chessboard .square{float:left}.chessboard .white.square{background-color:#f0d9b5}.chessboard .black.square{background-color:#b58863}.chessboard .selected.square{background-color:#2fc5ff}.chessboard .bB,.chessboard .bK,.chessboard .bN,.chessboard .bP,.chessboard .bQ,.chessboard .bR,.chessboard .wB,.chessboard .wK,.chessboard .wN,.chessboard .wP,.chessboard .wQ,.chessboard .wR{background-image:url(data:image/png;base64,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)}.chessboard .promotion-overlay{display:none;position:absolute;left:0;top:0;right:0;bottom:0;background-color:rgba(0,0,0,.7)}.chessboard .promotion-wrapper{margin-left:auto;margin-right:auto;background-color:#fff;text-align:center}</style><style>body{font-family:sans-serif;color:#333;margin:auto;max-width:512px;text-align:center}header{background-color:rgba(0,0,0,.5);position:fixed;left:0;top:0;width:100%;height:100%;z-index:3}header>div{background-color:#fff;border:solid #000;border-radius:10px;margin:1em auto;position:relative;max-width:476px}#board,.status{margin-top:1em}.status{border:solid 2px;padding:5%;text-align:left}.hidden{visibility:hidden}.blur{filter:blur(5px)}.loader,.loader:after{border-radius:50%;width:10em;height:10em}.loader{margin:60px auto;font-size:10px;position:relative;text-indent:-9999em;border-top:1.1em solid rgba(0,0,0,.2);border-right:1.1em solid rgba(0,0,0,.2);border-bottom:1.1em solid rgba(0,0,0,.2);border-left:1.1em solid #000;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);-webkit-animation:load8 1.1s infinite linear;animation:load8 1.1s infinite linear}@-webkit-keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}</style><div class=loader>Loading...</div><main class=hidden><header><div><h1>WebRTC Chess</h1><p>This is a multiplayer version of the classical game of chess. You can start playing by sharing the below link with your opponent(or opening it in a new browser window).</p><a id=link href=# target=_blank>Loading Link ...</a><p>Hosted on <a href=https://github.com/abhineet97/webrtc-chess>Github</a></div></header><div class=blur><div id=board></div><div class=status><b>Status: </b><span id=msg>Loading...</span></div></div></main><script>!function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var p=n[s]={exports:{}};t[s][0].call(p.exports,function(e){var n=t[s][1][e];return r(n?n:e)},p,p.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t){t.exports.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,t.exports.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t.exports.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate},{}],2:[function(e,t){function n(e,t,s){return this instanceof n?(r.call(this),this.options=i.extend({serialization:"binary",reliable:!1},s),this.open=!1,this.type="data",this.peer=e,this.provider=t,this.id=this.options.connectionId||n._idPrefix+i.randomToken(),this.label=this.options.label||this.id,this.metadata=this.options.metadata,this.serialization=this.options.serialization,this.reliable=this.options.reliable,this._buffer=[],this._buffering=!1,this.bufferSize=0,this._chunkedData={},this.options._payload&&(this._peerBrowser=this.options._payload.browser),void o.startConnection(this,this.options._payload||{originator:!0})):new n(e,t,s)}var i=e("./util"),r=e("eventemitter3"),o=e("./negotiator"),s=e("reliable");i.inherits(n,r),n._idPrefix="dc_",n.prototype.initialize=function(e){this._dc=this.dataChannel=e,this._configureDataChannel()},n.prototype._configureDataChannel=function(){var e=this;i.supports.sctp&&(this._dc.binaryType="arraybuffer"),this._dc.onopen=function(){i.log("Data channel connection success"),e.open=!0,e.emit("open")},!i.supports.sctp&&this.reliable&&(this._reliable=new s(this._dc,i.debug)),this._reliable?this._reliable.onmessage=function(t){e.emit("data",t)}:this._dc.onmessage=function(t){e._handleDataMessage(t)},this._dc.onclose=function(){i.log("DataChannel closed for:",e.peer),e.close()}},n.prototype._handleDataMessage=function(e){var t=this,n=e.data,r=n.constructor;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(r===Blob)return void i.blobToArrayBuffer(n,function(e){n=i.unpack(e),t.emit("data",n)});if(r===ArrayBuffer)n=i.unpack(n);else if(r===String){var o=i.binaryStringToArrayBuffer(n);n=i.unpack(o)}}else"json"===this.serialization&&(n=JSON.parse(n));if(n.__peerData){var s=n.__peerData,a=this._chunkedData[s]||{data:[],count:0,total:n.total};return a.data[n.n]=n.data,a.count+=1,a.total===a.count&&(delete this._chunkedData[s],n=new Blob(a.data),this._handleDataMessage({data:n})),void(this._chunkedData[s]=a)}this.emit("data",n)},n.prototype.close=function(){this.open&&(this.open=!1,o.cleanup(this),this.emit("close"))},n.prototype.send=function(e,t){if(!this.open)return void this.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages."));if(this._reliable)return void this._reliable.send(e);var n=this;if("json"===this.serialization)this._bufferedSend(JSON.stringify(e));else if("binary"===this.serialization||"binary-utf8"===this.serialization){var r=i.pack(e),o=i.chunkedBrowsers[this._peerBrowser]||i.chunkedBrowsers[i.browser];if(o&&!t&&r.size>i.chunkedMTU)return void this._sendChunks(r);i.supports.sctp?i.supports.binaryBlob?this._bufferedSend(r):i.blobToArrayBuffer(r,function(e){n._bufferedSend(e)}):i.blobToBinaryString(r,function(e){n._bufferedSend(e)})}else this._bufferedSend(e)},n.prototype._bufferedSend=function(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this.bufferSize=this._buffer.length)},n.prototype._trySend=function(e){try{this._dc.send(e)}catch(e){this._buffering=!0;var t=this;return setTimeout(function(){t._buffering=!1,t._tryBuffer()},100),!1}return!0},n.prototype._tryBuffer=function(){if(0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this.bufferSize=this._buffer.length,this._tryBuffer())}},n.prototype._sendChunks=function(e){for(var t=i.chunk(e),n=0,r=t.length;r>n;n+=1){var e=t[n];this.send(e,!0)}},n.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case"ANSWER":this._peerBrowser=t.browser,o.handleSDP(e.type,this,t.sdp);break;case"CANDIDATE":o.handleCandidate(this,t.candidate);break;default:i.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.exports=n},{"./negotiator":5,"./util":8,eventemitter3:9,reliable:12}],3:[function(e){window.Socket=e("./socket"),window.MediaConnection=e("./mediaconnection"),window.DataConnection=e("./dataconnection"),window.Peer=e("./peer"),window.RTCPeerConnection=e("./adapter").RTCPeerConnection,window.RTCSessionDescription=e("./adapter").RTCSessionDescription,window.RTCIceCandidate=e("./adapter").RTCIceCandidate,window.Negotiator=e("./negotiator"),window.util=e("./util"),window.BinaryPack=e("js-binarypack")},{"./adapter":1,"./dataconnection":2,"./mediaconnection":4,"./negotiator":5,"./peer":6,"./socket":7,"./util":8,"js-binarypack":10}],4:[function(e,t){function n(e,t,s){return this instanceof n?(r.call(this),this.options=i.extend({},s),this.open=!1,this.type="media",this.peer=e,this.provider=t,this.metadata=this.options.metadata,this.localStream=this.options._stream,this.id=this.options.connectionId||n._idPrefix+i.randomToken(),void(this.localStream&&o.startConnection(this,{_stream:this.localStream,originator:!0}))):new n(e,t,s)}var i=e("./util"),r=e("eventemitter3"),o=e("./negotiator");i.inherits(n,r),n._idPrefix="mc_",n.prototype.addStream=function(e){i.log("Receiving stream",e),this.remoteStream=e,this.emit("stream",e)},n.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case"ANSWER":o.handleSDP(e.type,this,t.sdp),this.open=!0;break;case"CANDIDATE":o.handleCandidate(this,t.candidate);break;default:i.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},n.prototype.answer=function(e){if(this.localStream)return void i.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");this.options._payload._stream=e,this.localStream=e,o.startConnection(this,this.options._payload);for(var t=this.provider._getMessages(this.id),n=0,r=t.length;r>n;n+=1)this.handleMessage(t[n]);this.open=!0},n.prototype.close=function(){this.open&&(this.open=!1,o.cleanup(this),this.emit("close"))},t.exports=n},{"./negotiator":5,"./util":8,eventemitter3:9}],5:[function(e,t){var n=e("./util"),i=e("./adapter").RTCPeerConnection,r=e("./adapter").RTCSessionDescription,o=e("./adapter").RTCIceCandidate,s={pcs:{data:{},media:{}},queue:[]};s._idPrefix="pc_",s.startConnection=function(e,t){var i=s._getPeerConnection(e,t);if("media"===e.type&&t._stream&&i.addStream(t._stream),e.pc=e.peerConnection=i,t.originator){if("data"===e.type){var r={};n.supports.sctp||(r={reliable:t.reliable});var o=i.createDataChannel(e.label,r);e.initialize(o)}n.supports.onnegotiationneeded||s._makeOffer(e)}else s.handleSDP("OFFER",e,t.sdp)},s._getPeerConnection=function(e,t){s.pcs[e.type]||n.error(e.type+" is not a valid connection type. Maybe you overrode the `type` property somewhere."),s.pcs[e.type][e.peer]||(s.pcs[e.type][e.peer]={});var i;return s.pcs[e.type][e.peer],t.pc&&(i=s.pcs[e.type][e.peer][t.pc]),i&&"stable"===i.signalingState||(i=s._startPeerConnection(e)),i},s._startPeerConnection=function(e){n.log("Creating RTCPeerConnection.");var t=s._idPrefix+n.randomToken(),r={};"data"!==e.type||n.supports.sctp?"media"===e.type&&(r={optional:[{DtlsSrtpKeyAgreement:!0}]}):r={optional:[{RtpDataChannels:!0}]};var o=new i(e.provider.options.config,r);return s.pcs[e.type][e.peer][t]=o,s._setupListeners(e,o,t),o},s._setupListeners=function(e,t){var i=e.peer,r=e.id,o=e.provider;n.log("Listening for ICE candidates."),t.onicecandidate=function(t){t.candidate&&(n.log("Received ICE candidates for:",e.peer),o.socket.send({type:"CANDIDATE",payload:{candidate:t.candidate,type:e.type,connectionId:e.id},dst:i}))},t.oniceconnectionstatechange=function(){switch(t.iceConnectionState){case"disconnected":case"failed":n.log("iceConnectionState is disconnected, closing connections to "+i),e.close();break;case"completed":t.onicecandidate=n.noop}},t.onicechange=t.oniceconnectionstatechange,n.log("Listening for `negotiationneeded`"),t.onnegotiationneeded=function(){n.log("`negotiationneeded` triggered"),"stable"==t.signalingState?s._makeOffer(e):n.log("onnegotiationneeded triggered when not stable. Is another connection being established?")},n.log("Listening for data channel"),t.ondatachannel=function(e){n.log("Received data channel");var t=e.channel,s=o.getConnection(i,r);s.initialize(t)},n.log("Listening for remote stream"),t.onaddstream=function(e){n.log("Received remote stream");var t=e.stream,s=o.getConnection(i,r);"media"===s.type&&s.addStream(t)}},s.cleanup=function(e){n.log("Cleaning up PeerConnection to "+e.peer);var t=e.pc;!t||"closed"===t.readyState&&"closed"===t.signalingState||(t.close(),e.pc=null)},s._makeOffer=function(e){var t=e.pc;t.createOffer(function(i){n.log("Created offer."),!n.supports.sctp&&"data"===e.type&&e.reliable&&(i.sdp=Reliable.higherBandwidthSDP(i.sdp)),t.setLocalDescription(i,function(){n.log("Set localDescription: offer","for:",e.peer),e.provider.socket.send({type:"OFFER",payload:{sdp:i,type:e.type,label:e.label,connectionId:e.id,reliable:e.reliable,serialization:e.serialization,metadata:e.metadata,browser:n.browser},dst:e.peer})},function(t){e.provider.emitError("webrtc",t),n.log("Failed to setLocalDescription, ",t)})},function(t){e.provider.emitError("webrtc",t),n.log("Failed to createOffer, ",t)},e.options.constraints)},s._makeAnswer=function(e){var t=e.pc;t.createAnswer(function(i){n.log("Created answer."),!n.supports.sctp&&"data"===e.type&&e.reliable&&(i.sdp=Reliable.higherBandwidthSDP(i.sdp)),t.setLocalDescription(i,function(){n.log("Set localDescription: answer","for:",e.peer),e.provider.socket.send({type:"ANSWER",payload:{sdp:i,type:e.type,connectionId:e.id,browser:n.browser},dst:e.peer})},function(t){e.provider.emitError("webrtc",t),n.log("Failed to setLocalDescription, ",t)})},function(t){e.provider.emitError("webrtc",t),n.log("Failed to create answer, ",t)})},s.handleSDP=function(e,t,i){i=new r(i);var o=t.pc;n.log("Setting remote description",i),o.setRemoteDescription(i,function(){n.log("Set remoteDescription:",e,"for:",t.peer),"OFFER"===e&&s._makeAnswer(t)},function(e){t.provider.emitError("webrtc",e),n.log("Failed to setRemoteDescription, ",e)})},s.handleCandidate=function(e,t){var i=t.candidate,r=t.sdpMLineIndex;e.pc.addIceCandidate(new o({sdpMLineIndex:r,candidate:i})),n.log("Added ICE candidate for:",e.peer)},t.exports=s},{"./adapter":1,"./util":8}],6:[function(e,t){function n(e,t){return this instanceof n?(r.call(this),e&&e.constructor==Object?(t=e,e=void 0):e&&(e=e.toString()),t=i.extend({debug:0,host:i.CLOUD_HOST,port:i.CLOUD_PORT,key:"peerjs",path:"/",token:i.randomToken(),config:i.defaultConfig},t),this.options=t,"/"===t.host&&(t.host=window.location.hostname),"/"!==t.path[0]&&(t.path="/"+t.path),"/"!==t.path[t.path.length-1]&&(t.path+="/"),void 0===t.secure&&t.host!==i.CLOUD_HOST&&(t.secure=i.isSecure()),t.logFunction&&i.setLogFunction(t.logFunction),i.setLogLevel(t.debug),i.supports.audioVideo||i.supports.data?i.validateId(e)?i.validateKey(t.key)?t.secure&&"0.peerjs.com"===t.host?void this._delayedAbort("ssl-unavailable","The cloud server currently does not support HTTPS. Please run your own PeerServer to use HTTPS."):(this.destroyed=!1,this.disconnected=!1,this.open=!1,this.connections={},this._lostMessages={},this._initializeServerConnection(),void(e?this._initialize(e):this._retrieveId())):void this._delayedAbort("invalid-key",'API KEY "'+t.key+'" is invalid'):void this._delayedAbort("invalid-id",'ID "'+e+'" is invalid'):void this._delayedAbort("browser-incompatible","The current browser does not support WebRTC")):new n(e,t)}var i=e("./util"),r=e("eventemitter3"),o=e("./socket"),s=e("./mediaconnection"),a=e("./dataconnection");i.inherits(n,r),n.prototype._initializeServerConnection=function(){var e=this;this.socket=new o(this.options.secure,this.options.host,this.options.port,this.options.path,this.options.key),this.socket.on("message",function(t){e._handleMessage(t)}),this.socket.on("error",function(t){e._abort("socket-error",t)}),this.socket.on("disconnected",function(){e.disconnected||(e.emitError("network","Lost connection to server."),e.disconnect())}),this.socket.on("close",function(){e.disconnected||e._abort("socket-closed","Underlying socket is already closed.")})},n.prototype._retrieveId=function(){var e=this,t=new XMLHttpRequest,n=this.options.secure?"https://":"http://",r=n+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/id",o="?ts="+(new Date).getTime()+Math.random();r+=o,t.open("get",r,!0),t.onerror=function(t){i.error("Error retrieving ID",t);var n="";"/"===e.options.path&&e.options.host!==i.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),e._abort("server-error","Could not get an ID from the server."+n)},t.onreadystatechange=function(){return 4===t.readyState?200!==t.status?void t.onerror():void e._initialize(t.responseText):void 0},t.send(null)},n.prototype._initialize=function(e){this.id=e,this.socket.start(this.id,this.options.token)},n.prototype._handleMessage=function(e){var t,n=e.type,r=e.payload,o=e.src;switch(n){case"OPEN":this.emit("open",this.id),this.open=!0;break;case"ERROR":this._abort("server-error",r.msg);break;case"ID-TAKEN":this._abort("unavailable-id","ID `"+this.id+"` is taken");break;case"INVALID-KEY":this._abort("invalid-key",'API KEY "'+this.options.key+'" is invalid');break;case"LEAVE":i.log("Received leave message from",o),this._cleanupPeer(o);break;case"EXPIRE":this.emitError("peer-unavailable","Could not connect to peer "+o);break;case"OFFER":var c=r.connectionId;if(t=this.getConnection(o,c))i.warn("Offer received for existing Connection ID:",c);else{if("media"===r.type)t=new s(o,this,{connectionId:c,_payload:r,metadata:r.metadata}),this._addConnection(o,t),this.emit("call",t);else{if("data"!==r.type)return void i.warn("Received malformed connection type:",r.type);t=new a(o,this,{connectionId:c,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable}),this._addConnection(o,t),this.emit("connection",t)}for(var u=this._getMessages(c),p=0,h=u.length;h>p;p+=1)t.handleMessage(u[p])}break;default:if(!r)return void i.warn("You received a malformed message from "+o+" of type "+n);var d=r.connectionId;t=this.getConnection(o,d),t&&t.pc?t.handleMessage(e):d?this._storeMessage(d,e):i.warn("You received an unrecognized message:",e)}},n.prototype._storeMessage=function(e,t){this._lostMessages[e]||(this._lostMessages[e]=[]),this._lostMessages[e].push(t)},n.prototype._getMessages=function(e){var t=this._lostMessages[e];return t?(delete this._lostMessages[e],t):[]},n.prototype.connect=function(e,t){if(this.disconnected)return i.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");var n=new a(e,this,t);return this._addConnection(e,n),n},n.prototype.call=function(e,t,n){if(this.disconnected)return i.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");if(!t)return void i.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");n=n||{},n._stream=t;var r=new s(e,this,n);return this._addConnection(e,r),r},n.prototype._addConnection=function(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t)},n.prototype.getConnection=function(e,t){var n=this.connections[e];if(!n)return null;for(var i=0,r=n.length;r>i;i++)if(n[i].id===t)return n[i];return null},n.prototype._delayedAbort=function(e,t){var n=this;i.setZeroTimeout(function(){n._abort(e,t)})},n.prototype._abort=function(e,t){i.error("Aborting!"),this._lastServerId?this.disconnect():this.destroy(),this.emitError(e,t)},n.prototype.emitError=function(e,t){i.error("Error:",t),"string"==typeof t&&(t=new Error(t)),t.type=e,this.emit("error",t)},n.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this.destroyed=!0)},n.prototype._cleanup=function(){if(this.connections)for(var e=Object.keys(this.connections),t=0,n=e.length;n>t;t++)this._cleanupPeer(e[t]);this.emit("close")},n.prototype._cleanupPeer=function(e){for(var t=this.connections[e],n=0,i=t.length;i>n;n+=1)t[n].close()},n.prototype.disconnect=function(){var e=this;i.setZeroTimeout(function(){e.disconnected||(e.disconnected=!0,e.open=!1,e.socket&&e.socket.close(),e.emit("disconnected",e.id),e._lastServerId=e.id,e.id=null)})},n.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)i.log("Attempting reconnection to server with ID "+this._lastServerId),this.disconnected=!1,this._initializeServerConnection(),this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");i.error("In a hurry? We're still trying to make the initial connection!")}},n.prototype.listAllPeers=function(e){e=e||function(){};var t=this,n=new XMLHttpRequest,r=this.options.secure?"https://":"http://",o=r+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/peers",s="?ts="+(new Date).getTime()+Math.random();o+=s,n.open("get",o,!0),n.onerror=function(){t._abort("server-error","Could not get peers from the server."),e([])},n.onreadystatechange=function(){if(4===n.readyState){if(401===n.status){var r="";throw r=t.options.host!==i.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",e([]),new Error("It doesn't look like you have permission to list peers IDs. "+r)}e(200!==n.status?[]:JSON.parse(n.responseText))}},n.send(null)},t.exports=n},{"./dataconnection":2,"./mediaconnection":4,"./socket":7,"./util":8,eventemitter3:9}],7:[function(e,t){function n(e,t,i,o,s){if(!(this instanceof n))return new n(e,t,i,o,s);r.call(this),this.disconnected=!1,this._queue=[];var a=e?"https://":"http://",c=e?"wss://":"ws://";this._httpUrl=a+t+":"+i+o+s,this._wsUrl=c+t+":"+i+o+"peerjs?key="+s}var i=e("./util"),r=e("eventemitter3");i.inherits(n,r),n.prototype.start=function(e,t){this.id=e,this._httpUrl+="/"+e+"/"+t,this._wsUrl+="&id="+e+"&token="+t,this._startXhrStream(),this._startWebSocket()},n.prototype._startWebSocket=function(){var e=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(t){try{var n=JSON.parse(t.data)}catch(e){return void i.log("Invalid server message",t.data)}e.emit("message",n)},this._socket.onclose=function(){i.log("Socket closed."),e.disconnected=!0,e.emit("disconnected")},this._socket.onopen=function(){e._timeout&&(clearTimeout(e._timeout),setTimeout(function(){e._http.abort(),e._http=null},5e3)),e._sendQueuedMessages(),i.log("Socket open")})},n.prototype._startXhrStream=function(e){try{var t=this;this._http=new XMLHttpRequest,this._http._index=1,this._http._streamIndex=e||0,this._http.open("post",this._httpUrl+"/id?i="+this._http._streamIndex,!0),this._http.onerror=function(){clearTimeout(t._timeout),t.emit("disconnected")},this._http.onreadystatechange=function(){2==this.readyState&&this.old?(this.old.abort(),delete this.old):this.readyState>2&&200===this.status&&this.responseText&&t._handleStream(this)},this._http.send(null),this._setHTTPTimeout()}catch(e){i.log("XMLHttpRequest not available; defaulting to WebSockets")}},n.prototype._handleStream=function(e){var t=e.responseText.split("\n");if(e._buffer)for(;e._buffer.length>0;){var n=e._buffer.shift(),r=t[n];try{r=JSON.parse(r)}catch(t){e._buffer.shift(n);break}this.emit("message",r)}var o=t[e._index];if(o)if(e._index+=1,e._index===t.length)e._buffer||(e._buffer=[]),e._buffer.push(e._index-1);else{try{o=JSON.parse(o)}catch(e){return void i.log("Invalid server message",o)}this.emit("message",o)}},n.prototype._setHTTPTimeout=function(){var e=this;this._timeout=setTimeout(function(){var t=e._http;e._wsOpen()?t.abort():(e._startXhrStream(t._streamIndex+1),e._http.old=t)},25e3)},n.prototype._wsOpen=function(){return this._socket&&1==this._socket.readyState},n.prototype._sendQueuedMessages=function(){for(var e=0,t=this._queue.length;t>e;e+=1)this.send(this._queue[e])},n.prototype.send=function(e){if(!this.disconnected){if(!this.id)return void this._queue.push(e);if(!e.type)return void this.emit("error","Invalid message");var t=JSON.stringify(e);if(this._wsOpen())this._socket.send(t);else{var n=new XMLHttpRequest,i=this._httpUrl+"/"+e.type.toLowerCase();n.open("post",i,!0),n.setRequestHeader("Content-Type","application/json"),n.send(t)}}},n.prototype.close=function(){!this.disconnected&&this._wsOpen()&&(this._socket.close(),this.disconnected=!0)},t.exports=n},{"./util":8,eventemitter3:9}],8:[function(e,t){var n={iceServers:[{url:"stun:stun.l.google.com:19302"}]},i=1,r=e("js-binarypack"),o=e("./adapter").RTCPeerConnection,s={noop:function(){},CLOUD_HOST:"0.peerjs.com",CLOUD_PORT:9e3,chunkedBrowsers:{Chrome:1},chunkedMTU:16300,logLevel:0,setLogLevel:function(e){var t=parseInt(e,10);s.logLevel=isNaN(parseInt(e,10))?e?3:0:t,s.log=s.warn=s.error=s.noop,s.logLevel>0&&(s.error=s._printWith("ERROR")),s.logLevel>1&&(s.warn=s._printWith("WARNING")),s.logLevel>2&&(s.log=s._print)},setLogFunction:function(e){e.constructor!==Function?s.warn("The log function you passed in is not a function. Defaulting to regular logs."):s._print=e},_printWith:function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e),s._print.apply(s,t)}},_print:function(){var e=!1,t=Array.prototype.slice.call(arguments);t.unshift("PeerJS: ");for(var n=0,i=t.length;i>n;n++)t[n]instanceof Error&&(t[n]="("+t[n].name+") "+t[n].message,e=!0);e?console.error.apply(console,t):console.log.apply(console,t)},defaultConfig:n,browser:function(){return window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported"}(),supports:function(){if("undefined"==typeof o)return{};var e,t,i=!0,r=!0,a=!1,c=!1,u=!!window.webkitRTCPeerConnection;try{e=new o(n,{optional:[{RtpDataChannels:!0}]})}catch(e){i=!1,r=!1}if(i)try{t=e.createDataChannel("_PEERJSTEST")}catch(e){i=!1}if(i){try{t.binaryType="blob",a=!0}catch(e){}var p=new o(n,{});try{var h=p.createDataChannel("_PEERJSRELIABLETEST",{});c=h.reliable}catch(e){}p.close()}if(r&&(r=!!e.addStream),!u&&i){var d=new o(n,{optional:[{RtpDataChannels:!0}]});d.onnegotiationneeded=function(){u=!0,s&&s.supports&&(s.supports.onnegotiationneeded=!0)},d.createDataChannel("_PEERJSNEGOTIATIONTEST"),setTimeout(function(){d.close()},1e3)}return e&&e.close(),{audioVideo:r,data:i,binaryBlob:a,binary:c,reliable:c,sctp:c,onnegotiationneeded:u}}(),validateId:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},validateKey:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},debug:!1,inherits:function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},pack:r.pack,unpack:r.unpack,log:function(){if(s.debug){var e=!1,t=Array.prototype.slice.call(arguments);t.unshift("PeerJS: ");for(var n=0,i=t.length;i>n;n++)t[n]instanceof Error&&(t[n]="("+t[n].name+") "+t[n].message,e=!0);e?console.error.apply(console,t):console.log.apply(console,t)}},setZeroTimeout:function(e){function t(t){i.push(t),e.postMessage(r,"*")}function n(t){t.source==e&&t.data==r&&(t.stopPropagation&&t.stopPropagation(),i.length&&i.shift()())}var i=[],r="zero-timeout-message";return e.addEventListener?e.addEventListener("message",n,!0):e.attachEvent&&e.attachEvent("onmessage",n),t}(window),chunk:function(e){for(var t=[],n=e.size,r=index=0,o=Math.ceil(n/s.chunkedMTU);n>r;){var a=Math.min(n,r+s.chunkedMTU),c=e.slice(r,a),u={__peerData:i,n:index,data:c,total:o};t.push(u),r=a,index+=1}return i+=1,t},blobToArrayBuffer:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsArrayBuffer(e)},blobToBinaryString:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},randomToken:function(){return Math.random().toString(36).substr(2)},isSecure:function(){return"https:"===location.protocol}};t.exports=s},{"./adapter":1,"js-binarypack":10}],9:[function(e,t){"use strict";function n(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(){}i.prototype._events=void 0,i.prototype.listeners=function(e){if(!this._events||!this._events[e])return[];for(var t=0,n=this._events[e].length,i=[];n>t;t++)i.push(this._events[e][t].fn);return i},i.prototype.emit=function(e,t,n,i,r,o){if(!this._events||!this._events[e])return!1;var s,a,c,u=this._events[e],p=u.length,h=arguments.length,d=u[0];if(1===p){switch(d.once&&this.removeListener(e,d.fn,!0),h){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,i),!0;case 5:return d.fn.call(d.context,t,n,i,r),!0;case 6:return d.fn.call(d.context,t,n,i,r,o),!0}for(a=1,s=new Array(h-1);h>a;a++)s[a-1]=arguments[a];d.fn.apply(d.context,s)}else for(a=0;p>a;a++)switch(u[a].once&&this.removeListener(e,u[a].fn,!0),h){case 1:u[a].fn.call(u[a].context);break;case 2:u[a].fn.call(u[a].context,t);break;case 3:u[a].fn.call(u[a].context,t,n);break;default:if(!s)for(c=1,s=new Array(h-1);h>c;c++)s[c-1]=arguments[c];u[a].fn.apply(u[a].context,s)}return!0},i.prototype.on=function(e,t,i){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new n(t,i||this)),this},i.prototype.once=function(e,t,i){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new n(t,i||this,!0)),this},i.prototype.removeListener=function(e,t,n){if(!this._events||!this._events[e])return this;var i=this._events[e],r=[];if(t)for(var o=0,s=i.length;s>o;o++)i[o].fn!==t&&i[o].once!==n&&r.push(i[o]);return this._events[e]=r.length?r:null,this},i.prototype.removeAllListeners=function(e){return this._events?(e?this._events[e]=null:this._events={},this):this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.EventEmitter=i,i.EventEmitter2=i,i.EventEmitter3=i,"object"==typeof t&&t.exports&&(t.exports=i)},{}],10:[function(e,t){function n(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function i(){this.bufferBuilder=new s}function r(e){var t=e.charCodeAt(0);return 2047>=t?"00":65535>=t?"000":2097151>=t?"0000":67108863>=t?"00000":"000000"}function o(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,r).length}var s=e("./bufferbuilder").BufferBuilder,a=e("./bufferbuilder").binaryFeatures,c={unpack:function(e){var t=new n(e);return t.unpack()},pack:function(e){var t=new i;t.pack(e);var n=t.getBuffer();return n}};t.exports=c,n.prototype.unpack=function(){var e=this.unpack_uint8();if(128>e){var t=e;return t}if(32>(224^e)){var n=(224^e)-32;return n}var i;if((i=160^e)<=15)return this.unpack_raw(i);if((i=176^e)<=15)return this.unpack_string(i);if((i=144^e)<=15)return this.unpack_array(i);if((i=128^e)<=15)return this.unpack_map(i);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return i=this.unpack_uint16(),this.unpack_string(i);case 217:return i=this.unpack_uint32(),this.unpack_string(i);case 218:return i=this.unpack_uint16(),this.unpack_raw(i);case 219:return i=this.unpack_uint32(),this.unpack_raw(i);case 220:return i=this.unpack_uint16(),this.unpack_array(i);case 221:return i=this.unpack_uint32(),this.unpack_array(i);case 222:return i=this.unpack_uint16(),this.unpack_map(i);case 223:return i=this.unpack_uint32(),this.unpack_map(i)}},n.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},n.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},n.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},n.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},n.prototype.unpack_int8=function(){var e=this.unpack_uint8();return 128>e?e:e-256},n.prototype.unpack_int16=function(){var e=this.unpack_uint16();return 32768>e?e:e-65536},n.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},n.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},n.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},n.prototype.unpack_string=function(e){for(var t,n,i=this.read(e),r=0,o="";e>r;)t=i[r],128>t?(o+=String.fromCharCode(t),r++):32>(192^t)?(n=(192^t)<<6|63&i[r+1],o+=String.fromCharCode(n),r+=2):(n=(15&t)<<12|(63&i[r+1])<<6|63&i[r+2],o+=String.fromCharCode(n),r+=3);return this.index+=e,o},n.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;e>n;n++)t[n]=this.unpack();return t},n.prototype.unpack_map=function(e){for(var t={},n=0;e>n;n++){var i=this.unpack(),r=this.unpack();t[i]=r}return t},n.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=e>>31,n=(e>>23&255)-127,i=8388607&e|8388608;return(0==t?1:-1)*i*Math.pow(2,n-23)},n.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=e>>31,i=(e>>20&2047)-1023,r=1048575&e|1048576,o=r*Math.pow(2,i-20)+t*Math.pow(2,i-52);return(0==n?1:-1)*o},n.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},i.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},i.prototype.pack=function(e){var t=typeof e;if("string"==t)this.pack_string(e);else if("number"==t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==t)e===!0?this.bufferBuilder.append(195):e===!1&&this.bufferBuilder.append(194);else if("undefined"==t)this.bufferBuilder.append(192);else{if("object"!=t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File)this.pack_bin(e);else if(n==ArrayBuffer)this.pack_bin(a.useArrayBufferView?new Uint8Array(e):e);else if("BYTES_PER_ELEMENT"in e)this.pack_bin(a.useArrayBufferView?new Uint8Array(e.buffer):e.buffer);else if(n==Object)this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{
if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},i.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(15>=t)this.pack_uint8(160+t);else if(65535>=t)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},i.prototype.pack_string=function(e){var t=o(e);if(15>=t)this.pack_uint8(176+t);else if(65535>=t)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},i.prototype.pack_array=function(e){var t=e.length;if(15>=t)this.pack_uint8(144+t);else if(65535>=t)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(4294967295>=t))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;t>n;n++)this.pack(e[n])},i.prototype.pack_integer=function(e){if(e>=-32&&127>=e)this.bufferBuilder.append(255&e);else if(e>=0&&255>=e)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&127>=e)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&65535>=e)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&32767>=e)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&4294967295>=e)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&2147483647>=e)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&0x8000000000000000>=e)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&0x10000000000000000>=e))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},i.prototype.pack_double=function(e){var t=0;0>e&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),i=e/Math.pow(2,n)-1,r=Math.floor(i*Math.pow(2,52)),o=Math.pow(2,32),s=t<<31|n+1023<<20|r/o&1048575,a=r%o;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},i.prototype.pack_object=function(e){var t=Object.keys(e),n=t.length;if(15>=n)this.pack_uint8(128+n);else if(65535>=n)this.bufferBuilder.append(222),this.pack_uint16(n);else{if(!(4294967295>=n))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(n)}for(var i in e)e.hasOwnProperty(i)&&(this.pack(i),this.pack(e[i]))},i.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},i.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},i.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},i.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},i.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":11}],11:[function(e,t){function n(){this._pieces=[],this._parts=[]}var i={};i.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),i.useArrayBufferView=!i.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=i;var r=t.exports.BlobBuilder;"undefined"!=typeof window&&(r=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),n.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},n.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);i.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},n.prototype.getBuffer=function(){if(this.flush(),i.useBlobBuilder){for(var e=new r,t=0,n=this._parts.length;n>t;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=n},{}],12:[function(e,t){function n(e,t){return this instanceof n?(this._dc=e,i.debug=t,this._outgoing={},this._incoming={},this._received={},this._window=1e3,this._mtu=500,this._interval=0,this._count=0,this._queue=[],void this._setupDC()):new n(e)}var i=e("./util");n.prototype.send=function(e){var t=i.pack(e);return t.size<this._mtu?void this._handleSend(["no",t]):(this._outgoing[this._count]={ack:0,chunks:this._chunk(t)},i.debug&&(this._outgoing[this._count].timer=new Date),this._sendWindowedChunks(this._count),void(this._count+=1))},n.prototype._setupInterval=function(){var e=this;this._timeout=setInterval(function(){var t=e._queue.shift();if(t._multiple)for(var n=0,i=t.length;i>n;n+=1)e._intervalSend(t[n]);else e._intervalSend(t)},this._interval)},n.prototype._intervalSend=function(e){var t=this;e=i.pack(e),i.blobToBinaryString(e,function(e){t._dc.send(e)}),0===t._queue.length&&(clearTimeout(t._timeout),t._timeout=null)},n.prototype._processAcks=function(){for(var e in this._outgoing)this._outgoing.hasOwnProperty(e)&&this._sendWindowedChunks(e)},n.prototype._handleSend=function(e){for(var t=!0,n=0,i=this._queue.length;i>n;n+=1){var r=this._queue[n];r===e?t=!1:r._multiple&&-1!==r.indexOf(e)&&(t=!1)}t&&(this._queue.push(e),this._timeout||this._setupInterval())},n.prototype._setupDC=function(){var e=this;this._dc.onmessage=function(t){var n=t.data,r=n.constructor;if(r===String){var o=i.binaryStringToArrayBuffer(n);n=i.unpack(o),e._handleMessage(n)}}},n.prototype._handleMessage=function(e){var t,n=e[1],r=this._incoming[n],o=this._outgoing[n];switch(e[0]){case"no":var s=n;s&&this.onmessage(i.unpack(s));break;case"end":if(t=r,this._received[n]=e[2],!t)break;this._ack(n);break;case"ack":if(t=o){var a=e[2];t.ack=Math.max(a,t.ack),t.ack>=t.chunks.length?(i.log("Time: ",new Date-t.timer),delete this._outgoing[n]):this._processAcks()}break;case"chunk":if(t=r,!t){var c=this._received[n];if(c===!0)break;t={ack:["ack",n,0],chunks:[]},this._incoming[n]=t}var u=e[2],p=e[3];t.chunks[u]=new Uint8Array(p),u===t.ack[2]&&this._calculateNextAck(n),this._ack(n);break;default:this._handleSend(e)}},n.prototype._chunk=function(e){for(var t=[],n=e.size,r=0;n>r;){var o=Math.min(n,r+this._mtu),s=e.slice(r,o),a={payload:s};t.push(a),r=o}return i.log("Created",t.length,"chunks."),t},n.prototype._ack=function(e){var t=this._incoming[e].ack;this._received[e]===t[2]&&(this._complete(e),this._received[e]=!0),this._handleSend(t)},n.prototype._calculateNextAck=function(e){for(var t=this._incoming[e],n=t.chunks,i=0,r=n.length;r>i;i+=1)if(void 0===n[i])return void(t.ack[2]=i);t.ack[2]=n.length},n.prototype._sendWindowedChunks=function(e){i.log("sendWindowedChunks for: ",e);for(var t=this._outgoing[e],n=t.chunks,r=[],o=Math.min(t.ack+this._window,n.length),s=t.ack;o>s;s+=1)n[s].sent&&s!==t.ack||(n[s].sent=!0,r.push(["chunk",e,s,n[s].payload]));t.ack+this._window>=n.length&&r.push(["end",e,n.length]),r._multiple=!0,this._handleSend(r)},n.prototype._complete=function(e){i.log("Completed called for",e);var t=this,n=this._incoming[e].chunks,r=new Blob(n);i.blobToArrayBuffer(r,function(e){t.onmessage(i.unpack(e))}),delete this._incoming[e]},n.higherBandwidthSDP=function(e){var t=navigator.appVersion.match(/Chrome\/(.*?) /);if(t&&(t=parseInt(t[1].split(".").shift()),31>t)){var n=e.split("b=AS:30"),i="b=AS:102400";if(n.length>1)return n[0]+i+n[1]}return e},n.prototype.onmessage=function(){},t.exports.Reliable=n},{"./util":13}],13:[function(e,t){var n=e("js-binarypack"),i={debug:!1,inherits:function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},pack:n.pack,unpack:n.unpack,log:function(){if(i.debug){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift("Reliable: "),console.log.apply(console,e)}},setZeroTimeout:function(e){function t(t){i.push(t),e.postMessage(r,"*")}function n(t){t.source==e&&t.data==r&&(t.stopPropagation&&t.stopPropagation(),i.length&&i.shift()())}var i=[],r="zero-timeout-message";return e.addEventListener?e.addEventListener("message",n,!0):e.attachEvent&&e.attachEvent("onmessage",n),t}(this),blobToArrayBuffer:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsArrayBuffer(e)},blobToBinaryString:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},randomToken:function(){return Math.random().toString(36).substr(2)}};t.exports=i},{"js-binarypack":10}]},{},[3]);</script><script>var Chess=function(r){function e(){ur=new Array(128),lr={w:x,b:x},pr=U,sr={w:0,b:0},cr=x,vr=0,gr=1,hr=[],dr={},a(i())}function n(){t(H)}function t(r){var n=r.split(/\s+/),t=n[0],f=0;if(!o(r).valid)return!1;e();for(var u=0;u<t.length;u++){var p=t.charAt(u);if("/"===p)f+=8;else if(O(p))f+=parseInt(p,10);else{var s="a">p?U:Q;l({type:p.toLowerCase(),color:s},R(f)),f++}}return pr=n[1],n[2].indexOf("K")>-1&&(sr.w|=er.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(sr.w|=er.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(sr.b|=er.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(sr.b|=er.QSIDE_CASTLE),cr="-"===n[3]?x:fr[n[3]],vr=parseInt(n[4],10),gr=parseInt(n[5],10),a(i()),!0}function o(r){var e={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},n=r.split(/\s+/);if(6!==n.length)return{valid:!1,error_number:1,error:e[1]};if(isNaN(n[5])||parseInt(n[5],10)<=0)return{valid:!1,error_number:2,error:e[2]};if(isNaN(n[4])||parseInt(n[4],10)<0)return{valid:!1,error_number:3,error:e[3]};if(!/^(-|[abcdefgh][36])$/.test(n[3]))return{valid:!1,error_number:4,error:e[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(n[2]))return{valid:!1,error_number:5,error:e[5]};if(!/^(w|b)$/.test(n[1]))return{valid:!1,error_number:6,error:e[6]};var t=n[0].split("/");if(8!==t.length)return{valid:!1,error_number:7,error:e[7]};for(var o=0;o<t.length;o++){for(var i=0,f=!1,a=0;a<t[o].length;a++)if(isNaN(t[o][a])){if(!/^[prnbqkPRNBQK]$/.test(t[o][a]))return{valid:!1,error_number:9,error:e[9]};i+=1,f=!1}else{if(f)return{valid:!1,error_number:8,error:e[8]};i+=parseInt(t[o][a],10),f=!0}if(8!==i)return{valid:!1,error_number:10,error:e[10]}}return"3"==n[3][1]&&"w"==n[1]||"6"==n[3][1]&&"b"==n[1]?{valid:!1,error_number:11,error:e[11]}:{valid:!0,error_number:0,error:e[0]}}function i(){for(var r=0,e="",n=fr.a8;n<=fr.h1;n++){if(null==ur[n])r++;else{r>0&&(e+=r,r=0);var t=ur[n].color,o=ur[n].type;e+=t===U?o.toUpperCase():o.toLowerCase()}n+1&136&&(r>0&&(e+=r),n!==fr.h1&&(e+="/"),r=0,n+=8)}var i="";sr[U]&er.KSIDE_CASTLE&&(i+="K"),sr[U]&er.QSIDE_CASTLE&&(i+="Q"),sr[Q]&er.KSIDE_CASTLE&&(i+="k"),sr[Q]&er.QSIDE_CASTLE&&(i+="q"),i=i||"-";var f=cr===x?"-":R(cr);return[e,pr,i,f,vr,gr].join(" ")}function f(r){for(var e=0;e<r.length;e+=2)"string"==typeof r[e]&&"string"==typeof r[e+1]&&(dr[r[e]]=r[e+1]);return dr}function a(r){hr.length>0||(r!==H?(dr.SetUp="1",dr.FEN=r):(delete dr.SetUp,delete dr.FEN))}function u(r){var e=ur[fr[r]];return e?{type:e.type,color:e.color}:null}function l(r,e){if(!("type"in r&&"color"in r))return!1;if(-1===W.indexOf(r.type.toLowerCase()))return!1;if(!(e in fr))return!1;var n=fr[e];return(r.type!=F||lr[r.color]==x||lr[r.color]==n)&&(ur[n]={type:r.type,color:r.color},r.type===F&&(lr[r.color]=n),a(i()),!0)}function p(r){var e=u(r);return ur[fr[r]]=null,e&&e.type===F&&(lr[e.color]=x),a(i()),e}function s(r,e,n,t,o){var i={color:pr,from:e,to:n,flags:t,piece:r[e].type};return o&&(i.flags|=er.PROMOTION,i.promotion=o),r[n]?i.captured=r[n].type:t&er.EP_CAPTURE&&(i.captured=$),i}function c(r){function e(r,e,n,t,o){if(r[n].type!==$||w(t)!==ir&&w(t)!==nr)e.push(s(r,n,t,o));else for(var i=[G,M,B,j],f=0,a=i.length;a>f;f++)e.push(s(r,n,t,o,i[f]))}var n=[],t=pr,o=N(t),i={b:or,w:tr},f=fr.a8,a=fr.h1,u=!1,l=!("undefined"!=typeof r&&"legal"in r)||r.legal;if("undefined"!=typeof r&&"square"in r){if(!(r.square in fr))return[];f=a=fr[r.square],u=!0}for(var p=f;a>=p;p++)if(136&p)p+=7;else{var c=ur[p];if(null!=c&&c.color===t)if(c.type===$){var v=p+z[t][0];if(null==ur[v]){e(ur,n,p,v,er.NORMAL);var v=p+z[t][1];i[t]===w(p)&&null==ur[v]&&e(ur,n,p,v,er.BIG_PAWN)}for(g=2;4>g;g++){var v=p+z[t][g];136&v||(null!=ur[v]&&ur[v].color===o?e(ur,n,p,v,er.CAPTURE):v===cr&&e(ur,n,p,cr,er.EP_CAPTURE))}}else for(var g=0,E=J[c.type].length;E>g;g++)for(var b=J[c.type][g],v=p;v+=b,!(136&v);){if(null!=ur[v]){if(ur[v].color===t)break;e(ur,n,p,v,er.CAPTURE);break}if(e(ur,n,p,v,er.NORMAL),"n"===c.type||"k"===c.type)break}}if(!u||a===lr[t]){if(sr[t]&er.KSIDE_CASTLE){var _=lr[t],y=_+2;null!=ur[_+1]||null!=ur[y]||h(o,lr[t])||h(o,_+1)||h(o,y)||e(ur,n,lr[t],y,er.KSIDE_CASTLE)}if(sr[t]&er.QSIDE_CASTLE){var _=lr[t],y=_-2;null!=ur[_-1]||null!=ur[_-2]||null!=ur[_-3]||h(o,lr[t])||h(o,_-1)||h(o,y)||e(ur,n,lr[t],y,er.QSIDE_CASTLE)}}if(!l)return n;for(var A=[],p=0,E=n.length;E>p;p++)m(n[p]),d(t)||A.push(n[p]),C();return A}function v(r,e){var n="";if(r.flags&er.KSIDE_CASTLE)n="O-O";else if(r.flags&er.QSIDE_CASTLE)n="O-O-O";else{var t=T(r,e);r.piece!==$&&(n+=r.piece.toUpperCase()+t),r.flags&(er.CAPTURE|er.EP_CAPTURE)&&(r.piece===$&&(n+=R(r.from)[0]),n+="x"),n+=R(r.to),r.flags&er.PROMOTION&&(n+="="+r.promotion.toUpperCase())}return m(r),E()&&(n+=b()?"#":"+"),C(),n}function g(r){return r.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function h(r,e){for(var n=fr.a8;n<=fr.h1;n++)if(136&n)n+=7;else if(null!=ur[n]&&ur[n].color===r){var t=ur[n],o=n-e,i=o+119;if(V[i]&1<<Y[t.type]){if(t.type===$){if(o>0){if(t.color===U)return!0}else if(t.color===Q)return!0;continue}if("n"===t.type||"k"===t.type)return!0;for(var f=X[i],a=n+f,u=!1;a!==e;){if(null!=ur[a]){u=!0;break}a+=f}if(!u)return!0}}return!1}function d(r){return h(N(r),lr[r])}function E(){return d(pr)}function b(){return E()&&0===c().length}function _(){return!E()&&0===c().length}function y(){for(var r={},e=[],n=0,t=0,o=fr.a8;o<=fr.h1;o++)if(t=(t+1)%2,136&o)o+=7;else{var i=ur[o];i&&(r[i.type]=i.type in r?r[i.type]+1:1,i.type===B&&e.push(t),n++)}if(2===n)return!0;if(3===n&&(1===r[B]||1===r[j]))return!0;if(n===r[B]+2){for(var f=0,a=e.length,o=0;a>o;o++)f+=e[o];if(0===f||f===a)return!0}return!1}function A(){for(var r=[],e={},n=!1;;){var t=C();if(!t)break;r.push(t)}for(;;){var o=i().split(" ").slice(0,4).join(" ");if(e[o]=o in e?e[o]+1:1,e[o]>=3&&(n=!0),!r.length)break;m(r.pop())}return n}function S(r){hr.push({move:r,kings:{b:lr.b,w:lr.w},turn:pr,castling:{b:sr.b,w:sr.w},ep_square:cr,half_moves:vr,move_number:gr})}function m(r){var e=pr,n=N(e);if(S(r),ur[r.to]=ur[r.from],ur[r.from]=null,r.flags&er.EP_CAPTURE&&(pr===Q?ur[r.to-16]=null:ur[r.to+16]=null),r.flags&er.PROMOTION&&(ur[r.to]={type:r.promotion,color:e}),ur[r.to].type===F){if(lr[ur[r.to].color]=r.to,r.flags&er.KSIDE_CASTLE){var t=r.to-1,o=r.to+1;ur[t]=ur[o],ur[o]=null}else if(r.flags&er.QSIDE_CASTLE){var t=r.to+1,o=r.to-2;ur[t]=ur[o],ur[o]=null}sr[e]=""}if(sr[e])for(var i=0,f=ar[e].length;f>i;i++)if(r.from===ar[e][i].square&&sr[e]&ar[e][i].flag){sr[e]^=ar[e][i].flag;break}if(sr[n])for(var i=0,f=ar[n].length;f>i;i++)if(r.to===ar[n][i].square&&sr[n]&ar[n][i].flag){sr[n]^=ar[n][i].flag;break}cr=r.flags&er.BIG_PAWN?"b"===pr?r.to-16:r.to+16:x,r.piece===$?vr=0:r.flags&(er.CAPTURE|er.EP_CAPTURE)?vr=0:vr++,pr===Q&&gr++,pr=N(pr)}function C(){var r=hr.pop();if(null==r)return null;var e=r.move;lr=r.kings,pr=r.turn,sr=r.castling,cr=r.ep_square,vr=r.half_moves,gr=r.move_number;var n=pr,t=N(pr);if(ur[e.from]=ur[e.to],ur[e.from].type=e.piece,ur[e.to]=null,e.flags&er.CAPTURE)ur[e.to]={type:e.captured,color:t};else if(e.flags&er.EP_CAPTURE){var o;o=n===Q?e.to-16:e.to+16,ur[o]={type:$,color:t}}if(e.flags&(er.KSIDE_CASTLE|er.QSIDE_CASTLE)){var i,f;e.flags&er.KSIDE_CASTLE?(i=e.to+1,f=e.to-1):e.flags&er.QSIDE_CASTLE&&(i=e.to-2,f=e.to+1),ur[i]=ur[f],ur[f]=null}return e}function T(r,e){for(var n=c({legal:!e}),t=r.from,o=r.to,i=r.piece,f=0,a=0,u=0,l=0,p=n.length;p>l;l++){var s=n[l].from,v=n[l].to,g=n[l].piece;i===g&&t!==s&&o===v&&(f++,w(t)===w(s)&&a++,L(t)===L(s)&&u++)}return f>0?a>0&&u>0?R(t):R(t).charAt(u>0?1:0):""}function I(){for(var r="   +------------------------+\n",e=fr.a8;e<=fr.h1;e++){if(0===L(e)&&(r+=" "+"87654321"[w(e)]+" |"),null==ur[e])r+=" . ";else{var n=ur[e].type,t=ur[e].color,o=t===U?n.toUpperCase():n.toLowerCase();r+=" "+o+" "}e+1&136&&(r+="|\n",e+=8)}return r+="   +------------------------+\n",r+="     a  b  c  d  e  f  g  h\n"}function P(r,e){var n=g(r);if(e){var t=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(t)var o=t[1],i=t[2],f=t[3],a=t[4]}for(var u=c(),l=0,p=u.length;p>l;l++){if(n===g(v(u[l]))||e&&n===g(v(u[l],!0)))return u[l];if(!(!t||o&&o.toLowerCase()!=u[l].piece||fr[i]!=u[l].from||fr[f]!=u[l].to||a&&a.toLowerCase()!=u[l].promotion))return u[l]}return null}function w(r){return r>>4}function L(r){return 15&r}function R(r){var e=L(r),n=w(r);return"abcdefgh".substring(e,e+1)+"87654321".substring(n,n+1)}function N(r){return r===U?Q:U}function O(r){return-1!=="0123456789".indexOf(r)}function k(r){var e=q(r);e.san=v(e,!1),e.to=R(e.to),e.from=R(e.from);var n="";for(var t in er)er[t]&e.flags&&(n+=rr[t]);return e.flags=n,e}function q(r){var e=r instanceof Array?[]:{};for(var n in r)"object"==typeof n?e[n]=q(r[n]):e[n]=r[n];return e}function D(r){return r.replace(/^\s+|\s+$/g,"")}function K(r){for(var e=c({legal:!1}),n=0,t=pr,o=0,i=e.length;i>o;o++){if(m(e[o]),!d(t))if(r-1>0){var f=K(r-1);n+=f}else n++;C()}return n}var Q="b",U="w",x=-1,$="p",j="n",B="b",M="r",G="q",F="k",W="pnbrqkPNBRQK",H="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Z=["1-0","0-1","1/2-1/2","*"],z={b:[16,32,17,15],w:[-16,-32,-17,-15]},J={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},V=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],X=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],Y={p:0,n:1,b:2,r:3,q:4,k:5},rr={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},er={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},nr=7,tr=6,or=1,ir=0,fr={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},ar={w:[{square:fr.a1,flag:er.QSIDE_CASTLE},{square:fr.h1,flag:er.KSIDE_CASTLE}],b:[{square:fr.a8,flag:er.QSIDE_CASTLE},{square:fr.h8,flag:er.KSIDE_CASTLE}]},ur=new Array(128),lr={w:x,b:x},pr=U,sr={w:0,b:0},cr=x,vr=0,gr=1,hr=[],dr={};return t("undefined"==typeof r?H:r),{WHITE:U,BLACK:Q,PAWN:$,KNIGHT:j,BISHOP:B,ROOK:M,QUEEN:G,KING:F,SQUARES:function(){for(var r=[],e=fr.a8;e<=fr.h1;e++)136&e?e+=7:r.push(R(e));return r}(),FLAGS:rr,load:function(r){return t(r)},reset:function(){return n()},moves:function(r){for(var e=c(r),n=[],t=0,o=e.length;o>t;t++)n.push("undefined"!=typeof r&&"verbose"in r&&r.verbose?k(e[t]):v(e[t],!1));return n},in_check:function(){return E()},in_checkmate:function(){return b()},in_stalemate:function(){return _()},in_draw:function(){return vr>=100||_()||y()||A()},insufficient_material:function(){return y()},in_threefold_repetition:function(){return A()},game_over:function(){return vr>=100||b()||_()||y()||A()},validate_fen:function(r){return o(r)},fen:function(){return i()},pgn:function(r){var e="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\n",n="object"==typeof r&&"number"==typeof r.max_width?r.max_width:0,t=[],o=!1;for(var i in dr)t.push("["+i+' "'+dr[i]+'"]'+e),o=!0;o&&hr.length&&t.push(e);for(var f=[];hr.length>0;)f.push(C());for(var a=[],u="";f.length>0;){var l=f.pop();hr.length||"b"!==l.color?"w"===l.color&&(u.length&&a.push(u),u=gr+"."):u=gr+". ...",u=u+" "+v(l,!1),m(l)}if(u.length&&a.push(u),"undefined"!=typeof dr.Result&&a.push(dr.Result),0===n)return t.join("")+a.join(" ");for(var p=0,i=0;i<a.length;i++)p+a[i].length>n&&0!==i?(" "===t[t.length-1]&&t.pop(),t.push(e),p=0):0!==i&&(t.push(" "),p++),t.push(a[i]),p+=a[i].length;return t.join("")},load_pgn:function(r,e){function o(r){return r.replace(/\\/g,"\\")}function i(r){for(var e in r)return!0;return!1}function a(r,e){for(var n="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\r?\n",t={},i=r.split(new RegExp(o(n))),f="",a="",u=0;u<i.length;u++)f=i[u].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),a=i[u].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),D(f).length>0&&(t[f]=a);return t}var u="undefined"!=typeof e&&"sloppy"in e&&e.sloppy,l="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\r?\n",p=new RegExp("^(\\[(.|"+o(l)+")*\\])("+o(l)+")*1.("+o(l)+"|.)*$","g"),s=r.replace(p,"$1");"["!==s[0]&&(s=""),n();var c=a(s,e);for(var v in c)f([v,c[v]]);if("1"===c.SetUp&&!("FEN"in c&&t(c.FEN)))return!1;var g=r.replace(s,"").replace(new RegExp(o(l),"g")," ");g=g.replace(/(\{[^}]+\})+?/g,"");for(var h=/(\([^\(\)]+\))+?/g;h.test(g);)g=g.replace(h,"");g=g.replace(/\d+\.(\.\.)?/g,""),g=g.replace(/\.\.\./g,""),g=g.replace(/\$\d+/g,"");var d=D(g).split(new RegExp(/\s+/));d=d.join(",").replace(/,,+/g,",").split(",");for(var E="",b=0;b<d.length-1;b++){if(E=P(d[b],u),null==E)return!1;m(E)}if(E=d[d.length-1],Z.indexOf(E)>-1)i(dr)&&"undefined"==typeof dr.Result&&f(["Result",E]);else{if(E=P(E,u),null==E)return!1;m(E)}return!0},header:function(){return f(arguments)},ascii:function(){return I()},turn:function(){return pr},move:function(r,e){var n="undefined"!=typeof e&&"sloppy"in e&&e.sloppy,t=null;if("string"==typeof r)t=P(r,n);else if("object"==typeof r)for(var o=c(),i=0,f=o.length;f>i;i++)if(!(r.from!==R(o[i].from)||r.to!==R(o[i].to)||"promotion"in o[i]&&r.promotion!==o[i].promotion)){t=o[i];break}if(!t)return null;var a=k(t);return m(t),a},undo:function(){var r=C();return r?k(r):null},clear:function(){return e()},put:function(r,e){return l(r,e)},get:function(r){return u(r)},remove:function(r){return p(r)},perft:function(r){return K(r)},square_color:function(r){if(r in fr){var e=fr[r];return(w(e)+L(e))%2===0?"light":"dark"}return null},history:function(r){for(var e=[],n=[],t=("undefined"!=typeof r&&"verbose"in r&&r.verbose);hr.length>0;)e.push(C());for(;e.length>0;){var o=e.pop();n.push(t?k(o):v(o)),m(o)}return n}}};"undefined"!=typeof exports&&(exports.Chess=Chess),"undefined"!=typeof define&&define(function(){return Chess});</script><script>"use strict";window.ChessBoard=function(e,t){function n(e,t){return String.fromCharCode(97+t)+e}function r(){var t=document.getElementById(e);t.classList.add("chessboard"),"b"===g.orientation&&t.classList.add("flipped"),E.element=t;for(var r=8;r>=1;r--){var a=document.createElement("div");E[r]={element:a};for(var i=0;i<8;i++){var l=document.createElement("div");(r+i)%2===0?l.className="white square":l.className="black square",l.setAttribute("data-square",n(r,i)),g.onSquareClick&&l.addEventListener("click",m),E[r][i]={element:l,piece:null},a.appendChild(l)}t.appendChild(a)}}function a(e){var t=document.createElement("div");return t.className="square "+e,t.setAttribute("data-piece",e),S.pieces.push({piece:e,element:t}),t}function i(e){var t=document.createElement("div");t.className="pieces",t.appendChild(a(e+"Q")),t.appendChild(a(e+"R")),t.appendChild(a(e+"N")),t.appendChild(a(e+"B")),"w"===e?S.whitePiecesWrapper=t:S.blackPiecesWrapper=t}function l(){i("w"),i("b");var e=document.createElement("button"),t=document.createTextNode("Promote");e.appendChild(t),S.promoteButton=e;var n=document.createElement("div");n.appendChild(e),S.promoteButtonWrapper=n;var r=document.createElement("div");r.className="promotion-wrapper",r.appendChild(S.whitePiecesWrapper),r.appendChild(S.blackPiecesWrapper),r.appendChild(n),S.wrapper=r;var a=document.createElement("div");a.className="promotion-overlay",S.overlay=a,a.appendChild(r),E.element.appendChild(a);for(var l=0,o=S.pieces.length;l<o;l++)S.pieces[l].element.addEventListener("click",s);e.addEventListener("click",c)}function s(e){var t=e.target;if(t!==S.selectedElement){if(null===S.selectedElement)return S.selectedElement=t,t.classList.add("selected"),void(S.promoteButton.disabled=!1);S.selectedElement.classList.remove("selected"),S.selectedElement=t,t.classList.add("selected")}}function c(){var e=S.selectedElement.getAttribute("data-piece"),t=String.fromCharCode(e.charCodeAt(1)+32);S.overlay.style.display="none",S.callback&&S.callback(t)}function o(){var e=getComputedStyle(E.element.parentNode),t=parseInt(e.width)-parseInt(e.paddingLeft)-parseInt(e.paddingRight);C=Math.floor((t-2*x)/8),C=Math.min(C,g.maxSquareSize),C=Math.max(C,g.minSquareSize)}function p(){o();var e=C+"px",t=8*C+"px",n=6*C+"px";E.element.style.width=8*C+P+"px";for(var r=8;r>=1;r--){E[r].element.style.width=t,E[r].element.style.height=e;for(var a=0;a<8;a++)E[r][a].element.style.width=e,E[r][a].element.style.height=e,E[r][a].element.style.backgroundSize=n,E[r][a].element.style.backgroundPosition=d(E[r][a].piece)}S.wrapper.style.width=4*C+"px",S.wrapper.style.height=2*C+"px",S.wrapper.style.marginTop=3*C+"px",S.whitePiecesWrapper.style.height=e,S.blackPiecesWrapper.style.height=e;for(var i=0,l=S.pieces.length;i<l;i++){var s=S.pieces[i].piece,c=S.pieces[i].element;c.style.width=e,c.style.height=e,c.style.backgroundSize=n,c.style.backgroundPosition=d(s)}S.promoteButtonWrapper.style.height=e,S.promoteButtonWrapper.style.lineHeight=e,S.promoteButton.style.fontSize=C/2.5+"px"}function d(e){switch(e){case"wP":return"0 0";case"wB":return-1*C+"px 0";case"wN":return-2*C+"px 0";case"wR":return-3*C+"px 0";case"wQ":return-4*C+"px 0";case"wK":return-5*C+"px 0";case"bP":return"0 "+-1*C+"px";case"bB":return-1*C+"px "+-1*C+"px";case"bN":return-2*C+"px "+-1*C+"px";case"bR":return-3*C+"px "+-1*C+"px";case"bQ":return-4*C+"px "+-1*C+"px";case"bK":return-5*C+"px "+-1*C+"px"}}function u(e){var t=e[0].charCodeAt(0)-97,n=+e[1];return E[n][t]}function m(e){var t=e.target.getAttribute("data-square");g.onSquareClick(t,k)}function h(e){var t=u(e),n=t.piece;null!==n&&t.element.classList.remove(n),t.piece=null}function v(e,t){for(var n="";n.length<t;)n+=e;return n}function f(e,t){var n=u(e),r=n.piece;null!==r&&n.element.classList.remove(r),n.element.classList.add(t),n.element.style.backgroundPosition=d(t),n.piece=t}function b(e){var t=e.charCodeAt(0);return t>=97?"b"+String.fromCharCode(t-32):"w"+e}var y=this,g={fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",resize:!0,orientation:"w",minSquareSize:20,maxSquareSize:64};for(var w in t)g[w]=t[w];var x,C,P,k=[],E={},S={pieces:[],selectedElement:null};this.selectSquare=function(e){if(!(k.indexOf(e)>-1)){var t=u(e);t.element.classList.add("selected"),k.push(e)}},this.unselectSquare=function(e){var t=k.indexOf(e);if(t!==-1){var n=u(e);n.element.classList.remove("selected"),k.splice(t,1)}},this.unselectAllSquares=function(){for(var e=0,t=k.length;e<t;e++){var n=u(k[e]);n.element.classList.remove("selected")}k=[]},this.setPosition=function(e){for(var t=e.split(" "),r=t[0].split("/"),a=0;a<8;a++){r[a]=r[a].replace(/\d/g,function(e){return v(".",+e)});for(var i=0;i<8;i++){var l=n(8-a,i);"."===r[a][i]?h(l):f(l,b(r[a][i]))}}},this.askPromotion=function(e,t){S.callback=t,S.whitePiecesWrapper.style.display="w"===e?"block":"none",S.blackPiecesWrapper.style.display="b"===e?"block":"none",S.promoteButton.disabled=!0,null!==S.selectedElement&&S.selectedElement.classList.remove("selected"),S.selectedElement=null,S.overlay.style.display="block"},r(),l(),setTimeout(function(){var e=getComputedStyle(E.element);x=parseInt(e.borderTopWidth),P="border-box"===e.boxSizing?2*x:0,p(),y.setPosition(g.fen)}),g.resize&&window.addEventListener("resize",p)};</script><script>"use strict";function hide(n){document.querySelector(n).classList.add("hidden")}function unhide(n){document.querySelector(n).classList.remove("hidden")}function setLink(n){document.querySelector("#link").href=n,document.querySelector("#link").innerHTML=n,loaded()}function loaded(){var n=document.querySelector(".loader");n.parentElement.removeChild(n),unhide("main")}function getOrientation(){return window.location.hash&&0!==window.location.hash.length?"b":"w"}function main(){var n,o,e,t,r,i,c,a=new Peer({key:"618b8av1yey4lsor"}),u={},d={},l=!1;e=function(e,t){if(!f())return void n.unselectSquare(e);if(0===t.length)return void(o.moves({square:e}).length>0&&n.selectSquare(e));var r=t[0];if(e===r)return void n.unselectSquare(e);var c=o.get(e),a=o.get(r);if(c&&c.color===a.color)return void n.unselectSquare(e);var u=o.moves({square:r,verbose:!0}),d=u.filter(function(n){return n.to===e}).length>0;return d?void("p"!==a.type||"1"!==e[1]&&"8"!==e[1]?i(r,e):n.askPromotion(a.color,function(n){i(r,e,n)})):void h("Invalid move. Try Again.")},i=function(e,t,r){o.move({from:e,to:t,promotion:r}),n.setPosition(o.fen()),s(),n.unselectAllSquares()};var s=function(){d.dataConnection.send(o.fen()),c()};c=function(){o.game_over()?(o.in_draw()&&h("Game Over. It's a DRAW."),h("Game Over. You have "+(o.turn()===u.color?"LOST":"WON"))):h(o.in_check()?(o.turn()===u.color?"You are":"Opponent is")+" in CHECK.":(o.turn()===u.color?"Your":"Opponent's")+" turn.")};var f=function(){return o.game_over()?(c(),!1):o.turn()!==u.color?(h("Not your turn"),!1):!!l||(h(a.disconnected?"Connection to your opponent has been lost.":"Please wait while we connect to your opponent..."),!1)},h=function(n){document.getElementById("msg").innerHTML=n};t=function(e){console.log("Recieved",e),o.load(e),n.setPosition(o.fen()),c()},r=function(n){"w"===u.color?h("Connected to opponent, play your turn."):(h("Connected to opponent, waiting for him/her to play..."),loaded()),l=!0,d.dataConnection=n,hide("header"),document.querySelector(".blur").classList.remove("blur")},a.on("open",function(n){if(h("Waiting for opponent..."),0!==window.location.hash.length){u={id:n,color:"b"},d={id:window.location.hash.split("#").pop(),color:"w"};var o=a.connect(d.id);h("Connecting to opponent..."),o.on("open",function(){r(o)}),o.on("data",t)}else u={color:"w",id:n},d={color:"b"},setLink(window.location.href+"#"+u.id)}),a.on("connection",function(n){n.on("open",function(){r(n)}),n.on("data",t)}),o=Chess(),n=new ChessBoard("board",{onSquareClick:e,orientation:getOrientation()})}document.addEventListener("DOMContentLoaded",main);</script>